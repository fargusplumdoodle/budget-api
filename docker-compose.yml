---
version: '3'
services:
 db:
  image: postgres
  environment:
   - POSTGRES_DB=budget
   - POSTGRES_USER=budget
   - POSTGRES_PASSWORD=budget
  volumes:
   - ./flutter/postgres-data:/var/lib/postgresql
  ports:
   - "5432:5432"
 api:
  image: "hub.sekhnet.ra/budget-api:dev"
  build:
    context: .
    dockerfile: Dockerfile-dev
  command: /venv/bin/python manage.py runserver 0.0.0.0:8000
  environment:
   - DB=postgres
   - DB_HOST=db
   - DB_USER=budget
   - DB_PASS=budget
   - DEBUG=TRUE
   - SECRET_KEY='TRUE'
  volumes:
   - .:/code
  ports:
   - "8000:8000"
  depends_on:
   - db
